{% extends "base.html" %}
{% block title %}Set Password{% endblock %}

{% block content %}
<div class="mx-auto" style="max-width:480px;">
  <div class="og-card p-4">
    <h1 class="h5 mb-3">Set your password</h1>

    {% if form.non_field_errors %}
      <div class="alert alert-warning py-2">{{ form.non_field_errors }}</div>
    {% endif %}

    <form method="post" novalidate id="resetForm">
      {% csrf_token %}
      <div class="form-floating mb-3">
        {{ form.password1.errors }}
        <input type="password" class="form-control" id="pwd1" name="password1" placeholder="New password" required>
        <label for="pwd1">New password</label>
      </div>

      <div class="form-floating mb-3">
        {{ form.password2.errors }}
        <input type="password" class="form-control" id="pwd2" name="password2" placeholder="Confirm password" required>
        <label for="pwd2">Confirm password</label>
      </div>

      <button class="btn btn-primary w-100" type="submit" id="submitBtn">Save password</button>
    </form>
  </div>
</div>

{% block extra_js %}
<script>
  // Evita duplo submit (que pode gerar um segundo POST sem CSRF válido após o login)
  (function(){
    const form = document.getElementById('resetForm');
    const btn  = document.getElementById('submitBtn');
    form.addEventListener('submit', function(){
      btn.disabled = true;
      btn.innerText = 'Saving...';
    });
  })();
</script>
{% endblock %}
{% endblock %}
